# Protocol for Research-Implementation Sync

To ensure seamless communication between the `research` (Plan Mode) and `implement` (Act Mode) agents, especially across different sessions, the following protocol should be adopted:

## 1. Persistent Task Storage
The `research` command MUST NOT only rely on the in-memory `todowrite` tool. It should save the planned tasks to a persistent file:
- **Location**: `.opencode/specs/[feature-id]/tasks.json`
- **Format**: JSON array of objects following the TodoList schema.

## 2. Implementation Auto-Discovery
The `implement` command should be enhanced with a "bootstrap" phase:
1. If the current `todoread` list is empty, search for the most recent `tasks.json` in the `.opencode/specs/` directory.
2. Automatically populate the TodoList using `todowrite`.

## 3. Session Context Linking
The Research report should explicitly state the `session_id` and the path to the task file.
Example:
> **Task Context**: session_4a5d... | Plan: .opencode/specs/asaas-import/tasks.json

## 4. Handoff Specification (spec.md)
The `spec.md` generated by the research agent should be treated as the source of truth. If TodoList is lost, the implementation agent should use the `tasks` section in `spec.md` to recreate the work items.

## 5. Metadata for Droids
Tasks should include `Droid: [name]` hints to help the Orchestrator delegate tasks more accurately without re-analyzing the files.
